<admintpl file="header"/>
</head>
<body>
<div class="wrap">
    <ul class="nav nav-tabs">
        <li><a href="{:U('adminAgent/index')}">{:L('AGENT_LIST')}</a></li>
        <li class="active"><a href="{:U('adminAgent/edit')}">{:L('AGENT_EDIT')}</a></li>
    </ul>
    <form id="form1" class="form-horizontal">
        <div class="control-group">
            <label class="control-label" >是否一级代理</label>
            <div class="controls">
                <span style="color: red;font-size: large;">
                    <if condition="$agent_first eq 0">
                        一级代理
                        <else/>
                        非一级代理
                    </if>
                </span>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="uid">用户ID</label>
            <div class="controls">
                <input type="text" id="uid" name="uid" value="{$data.uid}"  readonly="readonly">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="agent_name">代理名称</label>
            <div class="controls">
                <input type="text" id="agent_name" name="agent_name" value="{$data.agent_name}" placeholder="请填写商户名称">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">地区</label>
            <div class="controls">
                <select name="province" class="span3"></select> &nbsp;&nbsp;<select name="city" class="span3"></select>&nbsp;&nbsp;<select name="county" class="span3"></select>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="address">详细地址</label>
            <div class="controls">
                <input type="text" id="address" value="{$data.address}" name="address" placeholder="请填写详细地址">
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">代理方式</label>
            <div class="controls">
                <select name="agent_style"  class="span3 agent_style">
                    <option value="">请选择</option>
                    <option value="1" <if condition="$data.agent_style eq 1" >selected</if>>合同模式</option>
                    <option value="2" <if condition="$data.agent_style eq 2" >selected</if>>自定义模式</option>
                </select>
            </div>
        </div>
        <div class="control-group">
       <div style="width:50%;float: left;">
        <h3 align="center">D1业务</h3>
        <div class="control-group">
            <label class="control-label" for="wx_rate">微信的基准费率</label>
            <div class="controls">
                <input type="text" id="wx_rate" name="wx_rate" value="{$data.wx_rate}" placeholder="请填入微信的基准费率">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="ali_rate">支付宝的基准费率</label>
            <div class="controls">
                <input type="text" id="ali_rate" name="ali_rate" value="{$data.ali_rate}" placeholder="请填入支付宝的基准费率">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" >100万以下分润</label>
            <div class="controls">
                <input type="text" class="one_rate" name="one_rate" value="{$data.one_rate}" placeholder="请填入签约费率">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" >100万~500万费率</label>
            <div class="controls">
                <input type="text" class="two_rate" name="two_rate" value="{$data.two_rate}" placeholder="请填入签约费率">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" >500万~1000万费率</label>
            <div class="controls">
                <input type="text" class="three_rate" name="three_rate" value="{$data.three_rate}" placeholder="请填入签约费率">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" >1000万以上费率</label>
            <div class="controls">
                <input type="text" class="four_rate" name="four_rate" value="{$data.four_rate}" placeholder="请填入签约费率">
            </div>
        </div>
        </div>
        	<div style="width:50%;float: left;">
        <h3 align="center">D0业务</h3>
        <div class="control-group">
            <label class="control-label" for="wx_rate_0">微信的基准费率(百分比)</label>
            <div class="controls">
                <input type="text" id="wx_rate_0" name="wx_rate_0" value="{$data['wx_rate_0']}" placeholder="请填入微信的基准费率">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="ali_rate_0">支付宝的基准费率(百分比)</label>
            <div class="controls">
                <input type="text" id="ali_rate_0" name="ali_rate_0" value="{$data['ali_rate_0']}" placeholder="请填入支付宝的基准费率">
            </div>
        </div>
        
      	 <div class="control-group">
            <label class="control-label" for="poundage">单笔代付手续费金额(元)</label>
            <div class="controls">
                <input type="text" id="poundage" name="poundage" value="{$data['poundage']}"  placeholder="单笔代付手续费金额">
            </div>
        </div>
        
         <div class="control-group">
            <label class="control-label" for="repaid_rate">垫资费率(千分比)</label>
            <div class="controls">
                <input type="text" id="repaid_rate" name="repaid_rate" value="{$data['repaid_rate']}" placeholder="垫资费率">
            </div>
        </div>
        
         <div class="control-group">
            <label class="control-label" for="repaid_price">最低垫资费(元)</label>
            <div class="controls">
                <input type="text" id="repaid_price" name="repaid_price" value="{$data['repaid_price']}" placeholder="最低垫资费">
            </div>
        </div>
        
        
        </div>
        </div>
        <div class="control-group">
            <label class="control-label">代理类型</label>
            <div class="controls">
                <select name="agent_mode"  class="span3">
                    <option value="-1">请选择</option>
                    <option value="0" <if condition="$data.agent_mode eq 0" >selected</if>>个人</option>
                    <option value="1" <if condition="$data.agent_mode eq 1" >selected</if>>企业</option>
                </select>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">代理商角色</label>
            <div class="controls">
                <select name="juese"  class="span3">
                    <option value="">请选择</option>
                    <option value="1" <if condition="$data.juese eq 1" >selected</if>>代理</option>
                    <option value="2" <if condition="$data.juese eq 2" >selected</if>>员工</option>
                </select>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">开通会员卡权限</label>
            <div class="controls">
                <select name="card_auth"  class="span3">
                    <option value="0" <if condition="$data.card_auth eq 0" >selected</if>>关闭</option>
                    <option value="1" <if condition="$data.card_auth eq 1" >selected</if>>开通</option>
                </select>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">是否开通供应链</label>
            <div class="controls">
                <select name="supply_chain"  class="span3">
                    <option value="0" <if condition="$data.supply_chain eq 0" >selected</if>>关闭</option>
                    <option value="1" <if condition="$data.supply_chain eq 1" >selected</if>>开通</option>
                </select>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">新增类型</label>
            <div class="controls">
                <input name="agent_type" value="0" type="radio" <if condition="$data.agent_type eq 0">checked</if>/>直接发展 &nbsp;&nbsp;
                <input name="agent_type" value="1" type="radio" <if condition="$data.agent_type eq 1">checked</if>/>员工发展 &nbsp;&nbsp;
                <input name="agent_type" value="2" type="radio" <if condition="$data.agent_type eq 2">checked</if>/>内部员工推荐 &nbsp;&nbsp;
            </div>
        </div>
        <div class="control-group" id="referrer_div" style="display: none">
            <label class="control-label">推荐人</label>
            <div class="controls">
                <input name="referrer" value="{$data.referrer}" type="text"/>
            </div>
        </div>
        <if condition="$is_first_agent eq 1">
            <div class="control-group">
                <label class="control-label">代理业务</label>
                <div class="controls">
                    <foreach name="agency_business" item="vo">
                        <input name="agency_business[]" value="{$vo.key}" <if condition="$vo.checked eq 1">checked</if> type="checkbox" />{$vo.name} &nbsp;&nbsp;
                    </foreach>
                </div>
            </div>
        </if>

        <input type="hidden" name="id"  value="{$data.id}"/>
        <div class="form-actions">
            <button type="button" id="onSubmit" class="btn btn-primary js-ajax-submit" >{:L('EDIT')}</button>
            <a class="btn" href="javascript:history.back(-1);">{:L('BACK')}</a>
        </div>
    </form>
</div>
<script src="__PUBLIC__/js/common.js"></script>
<script src="__PUBLIC__/js/global.js"></script>
<script src="__PUBLIC__/js/PCASClass.js"></script> <!-- 省市县插件-->
<script>
    $(function () {
        new PCAS("province","city","county","{$data.province}","{$data.city}","{$data.county}"); //省市县

        $(".agent_style").change(function(){
            var agent_style = $(".agent_style").val();
            if(agent_style == "1"){
                $("#wx_rate").attr("disabled", true);
                $("#ali_rate").attr("disabled", true);
                $(".one_rate").attr("disabled",false);
                $(".two_rate").attr("disabled",false);
                $(".three_rate").attr("disabled",false);
                $(".four_rate").attr("disabled",false);
                $("#wx_rate").val(0.25);
                $("#ali_rate").val(0.25);
            }else if(agent_style == "2"){
                $("#wx_rate").attr("disabled", false);
                $("#ali_rate").attr("disabled", false);
                $(".one_rate").attr("disabled",true);
                $(".two_rate").attr("disabled",true);
                $(".three_rate").attr("disabled",true);
                $(".four_rate").attr("disabled",true);
                $(".one_rate").val("");
                $(".two_rate").val("");
                $(".three_rate").val("");
                $(".four_rate").val("");
                $("#wx_rate").val("");
                $("#ali_rate").val("");
            }
        });

        agent_type=$("input[name='agent_type']:checked").val();
        if(agent_type==2){
            $("#referrer_div").css("display","block");
        }

        $("input[name='agent_type']").click(function () {
            if($("input[name='agent_type']:checked").val()==2){
                $("#referrer_div").css("display","block");
            }else{
                $("#referrer_div").css("display","none");
            }
        });

        $("#onSubmit").click(function () {
            $.post('{:U("adminAgent/edit")}',$("#form1").serialize(),function (data) {
                if(data.code !=1){
                    alert(data.msg);
                    return;
                }else{
                    alert(data.msg);
                    location.href='{:U("adminAgent/index")}';
                }
            });
            
        });
        
        
        $("#add_user").click(function () {
            user_phone=$("#user_phone").val();
            $.post('{:U("AdminAgent/add_user")}',{user_phone:user_phone},function (data) {
                console.log(data);
                if(data.code==1){
                    $("#uid").val(data.uid);
                }else{
                    alert(data.msg);
                }

            });
        });
    });
</script>
<style>
    input{width: 60%;}
</style>
</body>
</html>