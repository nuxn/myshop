<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=100%; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
    <title>向商家付款</title>
    <style>
        *{margin:0;padding:0;}
        body{font-family:'微软雅黑';font-size:12px;}
        a{text-decoration:none;}
        li{list-style:none;}
        body,html{width:100%;height:100%;}
        .clear{clear:both;overflow:hidden;}
        .cleat{width:100%;position:fixed;bottom:0;left:0;}
        .cleat table{background:#f6f6f6;border-collapse: collapse;width:100%;border-bottom:solid 1px #ccc;}
        @font-face{
            font-family: "fzzdxjw";
            src: url("__TMPL__Public/pay/ttf/fzzdxjw.ttf")
        }
        .cleat table td{border-top:solid 1px #ccc;border-left:solid 1px #ccc;width:25%;text-align:center;color:#323232;padding:3% 0;font-size: 25px;}
        .cleat table td img{display:block;width:40%;margin:0 auto;}
        .cleat table tr td:nth-child(1){border-left:none;}
        .cleat table tr td.tbgds{background:#85BCEE;color:#fff;}
        .newconte{position:relative;width:96%;margin:4.5% auto 0 auto;}
        .newry label{margin-top:2%;color:#b6b6b6;font-size:15px;display:block;line-height:10px;}
        .newry input{display:block;line-height:28px;border:none;color:#ccc;margin-left:2%;outline:none;font-size:28px;}
        .newconte{padding:4.5% 0 4% 0;background:url(__TMPL__Public/pay/images/newbavk.jpg) bottom center no-repeat;background-size:100%;border-bottom:none;}
        .newry input::-webkit-input-placeholder {color: #ccc;}
        .newry input:-moz-placeholder {color: #ccc;}
        .newry input::-moz-placeholder{color: #ccc;}
        .newry input:-ms-input-placeholder {color: #ccc;}
        .newry input{text-align:right;width:70%;float:right;color:#000;font-family:'微软雅黑';margin-bottom:4%;margin-top:4%;background:none;margin-right:2%;}
        .newry input:focus{color:#1080d8}
        .newry label{font-size:17px;color:#323232;margin-top:3%;}
        .beizhu font{font-size:12px;position:absolute;right:4%;top:0;padding-top:2%;line-height:20px;display:block;color:#b6b6b6;}
        .newry{width:88%;margin:0 auto;}
        .tuos{width:80%;margin:8% auto 4% auto;}
        .tuos img{display:block;margin:0 auto;border-radius:52px;width:52px;}
        .tuos h4{display:block;text-align:center;color:#323232;font-size:17px;margin-top:7%;font-weight:500;}
        .btnlogon{width:120px;margin:2% auto;display:block;}
        .btns{width:86%;margin:1% auto 0 auto;}
        .btns label,.btns font{display:inline-block;float:left;color:#939393;font-size:14px;}
        .btns font{float:right;}
        @media (min-width:350px) and (max-width:430px){
            .newry{margin-top:3%;}
        }
    </style>
</head>
<body>
<input type="hidden" name="cate_id" value="{$cate_id}">
<input type="hidden" name="checker_id" value="{$checker_id}">
<div class="tuos clear"><img src="__TMPL__Public/pay/images/homeixon.jpg"/><h4>{$merchant['jianchen']}</h4></div>
<div class="newconte clear">
    <div class="newry clear"><label>消费金额(元)</label>
        <input placeholder="0" type="text" id="ontgj" readonly='readonly'>
    </div>
    <div class="btns clear">
        <label>　</label>
        <font></font>
    </div>
</div>
<div class="cleat clear">
    <img src="__TMPL__Public/pay/images/bickv.jpg" class="btnlogon"/>
    <table id="tabw">
        <tr>
            <td class="lxl" ontouchend="pay_money(this,1)">1</td>
            <td class="lxl" ontouchend="pay_money(this,1)">2</td>
            <td class="lxl" ontouchend="pay_money(this,1)">3</td>
            <td class="lxl" ontouchend="pay_money(this,3)"><img src="__TMPL__Public/pay/images/delect.png"/></td>
        </tr>
        <tr>
            <td class="lxl" ontouchend="pay_money(this,1)">4</td>
            <td class="lxl" ontouchend="pay_money(this,1)">5</td>
            <td class="lxl" ontouchend="pay_money(this,1)">6</td>
            <td class="tbgds" id="btnw" style="font-family:'微软雅黑';" rowspan=3 >支付</td>
        </tr>
        <tr>
            <td class="lxl" ontouchend="pay_money(this,1)">7</td>
            <td class="lxl" ontouchend="pay_money(this,1)">8</td>
            <td class="lxl" ontouchend="pay_money(this,1)">9</td>
        </tr>
        <tr>
            <td class="lxl" ontouchend="pay_money(this,1)" colspan=2>0</td>
            <td class="lxl" ontouchend="pay_money(this,1)">.</td>
        </tr>
    </table>
</div>
<script src="__TMPL__Public/pay/news/js/jquery.min.js"></script>
<script>
    var ab = 0;
    function pay_money(obj,tip){
        ab=0;
        if(tip==1){
            var con = $('#ontgj').val();
            var num = con + $(obj).html();

            if(num !=''&& num.substr(0,1) == '.'){
                num="";
            }
            num = num.replace(/[^\d.]/g,"");  //清除“数字”和“.”以外的字符
            num = num.replace(/\.{2,}/g,"."); //只保留第一个. 清除多余的
            num = num.replace(".","$#$").replace(/\./g,"").replace("$#$",".");
            num = num.replace(/^(\-)*(\d+)\.(\d\d).*$/,'$1$2.$3');//只能输入两个小数
            // 此处控制的是如果没有小数点，首位不能为类似于 01、02的金额
            if(num.indexOf(".")< 0 && num !="") {
                if (num.substr(0, 1) == '0' && num.length == 2) {
                    num = num.substr(1, num.length);
                }
            }
            if(num<=99999.99 && num.toString().length<=8){
                if(num.indexOf(".")>0){
                    num = num.replace(/\b(0+)/gi,"0");
                    if(num.toString().split(".")[1].length<=2){
                        $('#ontgj').val(num);
                    }
                }else {
                    $('#ontgj').val(num);
                }

            }
            if(num>0){
                $("#btnw").css('background','#329CFF');
            }
        }else if(tip==2){
            $('#ontgj').val("");
        }else if(tip==3){
            var con = $('#ontgj').val();
            var num = con.slice(0,-1);
            if(num < 0.01){
                $("#btnw").css('background','#85BCEE');
            }
            $('#ontgj').val(num);
        }
        event.preventDefault();
    }

    $('.lxl').on('touchmove',function(){$(this).css('background', '#f6f6f6')})
    $('.lxl').on('touchstart',function(){$(this).css('background', '#999999')})
    $('.lxl').on('touchend',function(){$(this).css('background', '#f6f6f6')})

    $('.tbgds').on('click',function () {
        var money = $('#ontgj').val();
        var cate_id = $('input[name=cate_id]').val();
        var checker_id = $('input[name=checker_id]').val();
        var host = window.location.host;
        if(ab<1){
            if(money>0){
                ab+=1;
                $('.tbgds').removeAttr('onclick');//去掉a标签中的onclick事件
                var price = parseFloat(money)+"/id/"+ cate_id +"/checker_id/"+checker_id+ "/ok";
                location = "https://sy.youngport.com.cn/index.php?s=Pay/Szlzpay/qr_to_alipay/price/" + price;
            }
        }
    });
</script>
</body>
</html>
