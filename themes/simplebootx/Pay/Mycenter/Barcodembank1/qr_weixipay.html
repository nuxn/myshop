<!-- Created by zgf on 2017/1/20. -->
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <title>向商家付款</title>
    <link rel="stylesheet" href="__TMPL__Public/pay/news/css/bootstrap.min.css">
    <link rel="stylesheet" href="__TMPL__Public/pay/news/css/basic.css">
    <link rel="stylesheet" href="__TMPL__Public/pay/news/js/font-awesome/css/font-awesome.min.css">
    <style>
        .a {
            height: 65px;
            line-height: 65px;
            text-align: center;
            border: 1px solid #ccc;
            background-color: white;
        }
        .up {
            border-top: none;
        }
        .left {
            border-left: none;
        }
        .b {
            height: 195px;
            padding: 65px 0;
            background-color: darkseagreen;
        }
        .b a{
            height: 195px;
            display: block;
            font-size: 20px;
            color: white;
        }
        .b a:hover {
            text-decoration: none;
        }
        .container-fluid {
            overflow: hidden;
            position: fixed;
            bottom: 0;
            height: 260px;
            color: #666;
            width: 100%;
            font-size: 30px;
            background-color: #ffffff;
        }
        .form-horizontal{
            margin: 0 auto;
            width: 90%;
            background: url("__TMPL__Public/pay/img/jiant.png")  center no-repeat;
            background-size:100% ;
        }
        .form-group {
            margin: 0 auto;
            width: 95%;
            height: 150px;
        }
        .form-group span {
            padding: 5px 10px 0 0;
            float: right;
            font-size: 15px;
            color: #999;
        }
        .input-group input {
            height: 60px;
            border: none;
            border-bottom: 1px solid #ccc;
            text-align: right;
            position: relative;
            top: -18px;
            color: #333333;
            font-size: 38px;
            -webkit-border-radius: 0;
            -moz-border-radius: 0;
            border-radius: 0;
        }
        .form-control[readonly] {
            background-color: #ffffff;
            opacity: 1;
        }
        .footer {
            overflow: hidden;
            position: fixed;
            bottom: 280px;
            margin: 0 auto;
            text-align: center;
            width: 100%;
            color: #999;
            font-size: 12px;
        }
        .pay_logo {
            margin:0 auto;
            width: auto;
            text-align:center;
            height: 40px;
            line-height:40px;
        }
        .pay_logo img {
            width: 40px;
            height: 34px;
        }

        .header {
            margin: 15px auto;
            width: 100%;
        }
        body {
            background-color: #ffffff;
        }
        .imgs {
            z-index:999;
            position: relative;
            height: 30px;
            width: 1px;
            display: block;
            top:-70px;
        }
        * {
            -webkit-touch-callout:none;
            -webkit-user-select:none;
            -khtml-user-select:none;
            -moz-user-select:none;
            -ms-user-select:none;
            user-select:none;
        }
    </style>
</head>

<body>
<div class="header">
    <p class="pay_logo">
        <img src="__TMPL__Public/pay/images/shop.png" alt="logo">&nbsp&nbsp{$merchant['jianchen']}
    </p>
</div>
<form class="form-horizontal" action="" method="post" enctype="multipart/form-data" name="pay">
    <input type="hidden" name="seller_id" value="{$seller_id}">
    <input type="hidden" name="openid" value="{$openid}">
    <input type="hidden" name="checker_id" value="{$checker_id}">
    <input type="hidden" name="mid" value="{$mid}">
    <div class="form-group">
        <p style="padding-top: 15px;font-size: 13px">消费金额(元)</p>
        <div class="input-group">
            <!--<div class="input-group-addon" style="font-size: 30px;">￥</div>-->
            <input type="text" name="money" value="" id="input-money" readonly="readonly"  class="form-control" />
        </div>
        <span class="imgs"><img src="__TMPL__Public/pay/images/cursor.gif" alt=""></span>
        <!--<span>关注洋仆淘商城，惊喜天天有</span>-->
        <p style="font-size: 13px">钱嘟嘟优惠 <img src="__TMPL__Public/pay/img/jian.jpg" alt="jian" style="width: 66px;height: 22px;position: relative;top: -5px;"></p>
    </div>
</form>
<div class="footer"><img src="__TMPL__Public/pay/images/qiandudu.png" alt="logo" style="width:30%;height: 12px; "></div>
<div class="container-fluid">
    <div class="row">
        <div class="col-xs-3 a" ontouchend="pay_money(this,1)">1</div>
        <div class="col-xs-3 a left" ontouchend="pay_money(this,1)">2</div>
        <div class="col-xs-3 a left" ontouchend="pay_money(this,1)">3</div>
        <div class="col-xs-3 a left" ontouchend="pay_money(this,3)"><img src="__TMPL__Public/pay/img/back.jpg" alt="back" style="width: 31px;height: 19px;position: relative; top: -4px;"></div>
    </div>
    <div class="row">
        <div class="col-xs-9">
            <div class="row">
                <div class="col-xs-4 a up" ontouchend="pay_money(this,1)">4</div>
                <div class="col-xs-4 a up left" ontouchend="pay_money(this,1)">5</div>
                <div class="col-xs-4 a up left" ontouchend="pay_money(this,1)">6</div>
            </div>
            <div class="row">
                <div class="col-xs-4 a up" ontouchend="pay_money(this,1)">7</div>
                <div class="col-xs-4 a up left" ontouchend="pay_money(this,1)">8</div>
                <div class="col-xs-4 a up left" ontouchend="pay_money(this,1)">9</div>
            </div>
            <div class="row">
                <div class="col-xs-8 a up" ontouchend="pay_money(this,1)">0</div>
                <div class="col-xs-4 a up left" ontouchend="pay_money(this,1)">.</div>
            </div>
        </div>
        <div class="col-xs-3 b left" align="center">
            <a href="###" class="text" id="pay"><img src="__TMPL__Public/pay/img/cheng.png" alt="back" style="width: 40px;height: 36px;position: relative; top: -4px;"><br>支付</a>
        </div>
    </div>
</div>
<script src="__TMPL__Public/pay/news/js/jquery.min.js"></script>
<script src="__TMPL__Public/pay/news/js/bootstrap.min.js"></script>
<script>
    $("#input-money").focus(function(){
        document.activeElement.blur();
    });
</script>
<script>
    var fm = document.pay;
    var num=0;
    var ab =0;
    function pay_money(obj,tip){
        $('#pay').attr('href',"");
        ab=0;
        if(tip==1){
            var con=document.getElementById('input-money').value;

            var num = con + obj.innerHTML;
            if(num == '.'){
                num = '0.';
            }
            if(num>0){
                $(".b").css('background','limegreen');
            }
            if(num>=1){
                num = num.replace(/\b(0+)/gi,"");
            }
            if(num<=99999.99 && num.toString().length<=8){
                if(num.indexOf(".")>0){
                    num = num.replace(/\b(0+)/gi,"0");
                    if(num.toString().split(".")[1].length<=2){
                        document.getElementById('input-money').value = num;
                    }
                }else {
                    document.getElementById('input-money').value = num;
                }

            }
        }else if(tip==2){
            document.getElementById('input-money').value="";
        }else if(tip==3){
            var con = document.getElementById('input-money').value;
            var num = con.slice(0,-1);
            if(num < 0.01){
                $(".b").css('background','darkseagreen');
            }
            document.getElementById('input-money').value = num;
        }
    }
    if(ab<1){
        $('#pay').on('click',function () {
            var money = fm.money.value;
            var id = fm.seller_id.value;
            var openid = fm.openid.value;
            var mid = (fm.mid.value)*100;
            var checker_id = fm.checker_id.value;
            if(money>0){
//            var price = parseFloat(money);
                var random=Math.ceil(Math.random()*100000);
                var price = parseFloat(money)+"/seller_id/"+ id + "/openid/"+openid+"/checker_id/"+checker_id+"/random/"+random+"/mid/"+mid+"/ok";
                ab+=1;
                if(ab<2) {
                    $('#pay').removeAttr('href');//去掉a标签中的href属性
                    $('#pay').removeAttr('onclick');//去掉a标签中的onclick事件
                    location = "https://sy.youngport.com.cn/index.php?s=/Pay/Barcode/wz_pay/price/" + price;
                }

//            location = "http://m.hz41319.com/wei/main/weipay/demo/qrcode.php?&price=" + price + "&id=" + id;

//            var price = parseFloat(money)+"/seller_id/"+ seller_id + "/ok";
//            location = "http://sy.youngport.com.cn/index.php?s=/Pay/Barcode/qr_to_alipay/price/" + price;

            }
        });
    }

</script>
</body>
</html>
